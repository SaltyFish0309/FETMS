---
phase: 02-component-dark-mode-coverage
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/documents/DocumentCard.tsx
  - frontend/src/components/documents/DocumentBox.tsx
  - frontend/src/components/documents/DocumentManager.tsx
  - frontend/src/components/settings/AlertRuleTable.tsx
  - frontend/src/components/settings/AlertRulesManager.tsx
  - frontend/src/components/settings/SortableStageItem.tsx
  - frontend/src/pages/StageSettings.tsx
autonomous: true
gap_closure: true
must_haves:
  truths:
    - "DocumentCard renders with bg-card/bg-muted in dark mode, not white/slate"
    - "AlertRuleTable text is visible (foreground/muted-foreground) in dark mode"
    - "SortableStageItem has visible border and background in dark mode"
    - "StageSettings page background works in dark mode"
  artifacts:
    - path: "frontend/src/components/documents/DocumentCard.tsx"
      contains: "bg-card"
    - path: "frontend/src/components/settings/AlertRuleTable.tsx"
      contains: "text-foreground"
    - path: "frontend/src/pages/StageSettings.tsx"
      contains: "bg-background"
  key_links: []
---

<objective>
Refactor Document and Settings components to remove hardcoded colors and use semantic tokens for dark mode compatibility.

Purpose: Fix verification gaps identified in Phase 2 where components were using slate/white hardcoded values.
Output: Components that adapt correctly to theme changes.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-component-dark-mode-coverage/02-VERIFICATION.md
@frontend/src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Document components colors</name>
  <files>
    frontend/src/components/documents/DocumentCard.tsx
    frontend/src/components/documents/DocumentBox.tsx
    frontend/src/components/documents/DocumentManager.tsx
  </files>
  <action>
    Refactor these files to use semantic tokens instead of hardcoded colors:

    1. DocumentCard.tsx:
       - Replace `bg-white` -> `bg-card`
       - Replace `border-slate-200` -> `border-border`
       - Replace `text-slate-900` -> `text-foreground`
       - Replace `text-slate-500` -> `text-muted-foreground`
       - Replace `hover:bg-slate-50` -> `hover:bg-muted/50`

    2. DocumentBox.tsx:
       - Replace `bg-slate-100` -> `bg-muted` or `bg-secondary`
       - Replace `text-slate-700` -> `text-muted-foreground`
       - Ensure icons use current color or semantic tokens

    3. DocumentManager.tsx:
       - Fix any container backgrounds or text colors
       - Ensure consistent use of `bg-background` and `text-foreground`

    General rules:
    - NO `slate-*`, `gray-*`, `zinc-*` (unless semantic)
    - NO `white` or `black` for backgrounds/text
  </action>
  <verify>
    grep -E "bg-white|bg-slate|text-slate|border-slate" frontend/src/components/documents/DocumentCard.tsx frontend/src/components/documents/DocumentBox.tsx frontend/src/components/documents/DocumentManager.tsx
    # Should return no matches (or only extremely specific intentional uses, if any)
  </verify>
  <done>
    Document components rely purely on semantic tokens defined in index.css.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix Settings components colors</name>
  <files>
    frontend/src/components/settings/AlertRuleTable.tsx
    frontend/src/components/settings/AlertRulesManager.tsx
    frontend/src/components/settings/SortableStageItem.tsx
    frontend/src/pages/StageSettings.tsx
  </files>
  <action>
    Refactor these files to use semantic tokens (User reported specific issues here):

    1. AlertRuleTable.tsx:
       - Fix table container `rounded-md border bg-white` -> `bg-card`
       - Header row: ensure it uses semantic `hover:bg-muted/50`
       - Text cells: `text-slate-900` -> `text-foreground`

    2. AlertRulesManager.tsx:
       - Fix form layout container: `flex flex-col` area likely has `bg-white`
       - Inputs/Buttons: Ensure they use standard Shadcn variants, not hardcoded styles
       - Label text: `text-slate-700` -> `text-foreground`

    3. SortableStageItem.tsx:
       - Item card: `bg-white` -> `bg-card`
       - Border: `border-slate-200` -> `border-border`
       - Text: `text-slate-900` -> `text-foreground`

    4. StageSettings.tsx:
       - Check the `max-w-2xl` container or surrounding elements for `bg-white`
       - Ensure the page background flows correctly

    Scan for and replace:
    - `bg-white` -> `bg-card` (or `bg-background` depending on context)
    - `border-slate-200` -> `border-border`
    - `text-slate-*` -> `text-foreground` / `text-muted-foreground`
  </action>
  <verify>
    grep -E "bg-white|bg-slate|text-slate|border-slate" frontend/src/components/settings/AlertRuleTable.tsx frontend/src/components/settings/AlertRulesManager.tsx frontend/src/components/settings/SortableStageItem.tsx frontend/src/pages/StageSettings.tsx
  </verify>
  <done>
    Settings components rely purely on semantic tokens.
  </done>
</task>

</tasks>

<verification>
Run the grep checks from the tasks. If they return matches, the task is not complete.
Manual check: Ensure no "flash" of white background or hardcoded slate text remains in these components.
</verification>

<success_criteria>
- All listed components utilize semantic Tailwind classes (bg-card, text-foreground, etc.)
- No hardcoded color palette values (slate-*) remain in these files
- Components visually match the rest of the dark mode application
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-dark-mode-coverage/02-09-SUMMARY.md`
</output>
