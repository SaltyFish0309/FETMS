---
phase: 02-component-dark-mode-coverage
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/dashboard/KPICard.tsx
  - frontend/src/components/dashboard/chartColors.ts
  - frontend/src/components/dashboard/PipelineChart.tsx
  - frontend/src/components/dashboard/DemographicsChart.tsx
  - frontend/src/components/dashboard/EducationChart.tsx
  - frontend/src/components/dashboard/SalaryChart.tsx
  - frontend/src/components/dashboard/SeniorityChart.tsx
autonomous: true

must_haves:
  truths:
    - "KPI cards display correctly in dark mode with readable text"
    - "All chart axis labels are readable in dark mode"
    - "Chart tooltips have proper dark mode styling"
    - "Chart colors maintain brand identity but work on dark backgrounds"
  artifacts:
    - path: "frontend/src/components/dashboard/KPICard.tsx"
      provides: "Dark-mode-aware KPI card"
      contains: "text-muted-foreground"
    - path: "frontend/src/components/dashboard/chartColors.ts"
      provides: "CSS variable based chart colors"
      contains: "var(--color-chart"
    - path: "frontend/src/components/dashboard/PipelineChart.tsx"
      provides: "Dark-mode-aware pipeline chart"
      contains: "var(--color-"
  key_links:
    - from: "frontend/src/components/dashboard/PipelineChart.tsx"
      to: "CSS variables in index.css"
      via: "var(--color-*) references in fill/stroke"
      pattern: "var\\(--color-"
---

<objective>
Fix KPI cards and all Recharts-based dashboard charts to work correctly in dark mode.

Purpose: KPI cards have hardcoded slate colors that fail in dark mode. Charts use hardcoded hex colors (#64748b) for axis labels, grid lines, and tooltips that don't adapt to theme changes.

Output: KPI cards and charts that render correctly in both light and dark themes using CSS variables.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-component-dark-mode-coverage/02-CONTEXT.md
@.planning/phases/02-component-dark-mode-coverage/02-RESEARCH.md
@frontend/src/index.css
@frontend/src/components/dashboard/KPICard.tsx
@frontend/src/components/dashboard/chartColors.ts
@frontend/src/components/dashboard/PipelineChart.tsx
@frontend/src/components/dashboard/DemographicsChart.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update KPICard with semantic colors</name>
  <files>frontend/src/components/dashboard/KPICard.tsx</files>
  <action>
Replace hardcoded colors in KPICard.tsx:

Current -> Replacement:
- `text-slate-500` -> `text-muted-foreground`
- `text-slate-800` -> `text-foreground`
- `bg-slate-50` -> `bg-muted`

For the gradient accent line (user decision: keep brand colors but allow dark mode adjustment):
The gradient classes like `from-blue-500 to-blue-600` can stay as-is since they're brand colors and provide sufficient contrast in both modes. However, if visual testing shows issues, can add dark: variants.

Keep the trend colors as-is (`text-emerald-600`, `text-red-500`) - these are semantic status colors that work in both modes.
  </action>
  <verify>
Run `npm run build --prefix frontend` to verify no errors.
`grep -E "text-slate-[0-9]|bg-slate-50" frontend/src/components/dashboard/KPICard.tsx` should return empty.
  </verify>
  <done>
KPICard uses semantic colors: text-muted-foreground for labels, text-foreground for values, bg-muted for icon backgrounds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update chartColors.ts to use CSS variables</name>
  <files>frontend/src/components/dashboard/chartColors.ts</files>
  <action>
Modify chartColors.ts to return CSS variable references instead of hardcoded hex values.

Replace the CHART_COLORS array to reference CSS variables:
```typescript
// Use CSS variable references that adapt to theme
export function getChartColor(index: number): string {
  const colors = [
    'var(--color-chart-1)',
    'var(--color-chart-2)',
    'var(--color-chart-3)',
    'var(--color-chart-4)',
    'var(--color-chart-5)',
    'var(--color-chart-6)',
  ];
  return colors[index % colors.length];
}
```

For GENDER_COLORS, since these are semantic (male=blue, female=pink), we can either:
A) Keep hex values (they're bright enough for both modes)
B) Create CSS variables for them

Choose option A for now - the current colors (#3B82F6, #EC4899, #64748B) provide sufficient contrast in both modes.

Add a helper for muted foreground color (for axis labels):
```typescript
export function getAxisColor(): string {
  return 'var(--color-muted-foreground)';
}

export function getBorderColor(): string {
  return 'var(--color-border)';
}
```
  </action>
  <verify>
`npm run build --prefix frontend` passes.
File contains `var(--color-chart` references.
  </verify>
  <done>
chartColors.ts exports getChartColor() returning CSS variable references, plus getAxisColor() and getBorderColor() helpers for chart theming.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update all chart components with theme-aware styling</name>
  <files>
    frontend/src/components/dashboard/PipelineChart.tsx
    frontend/src/components/dashboard/DemographicsChart.tsx
    frontend/src/components/dashboard/EducationChart.tsx
    frontend/src/components/dashboard/SalaryChart.tsx
    frontend/src/components/dashboard/SeniorityChart.tsx
  </files>
  <action>
Update each chart component to use CSS variables for theming. Import helpers from chartColors.ts.

For ALL chart files, apply these patterns:

1. **YAxis/XAxis tick colors**: Replace `fill: '#64748b'` with `fill: 'var(--color-muted-foreground)'`

2. **CartesianGrid stroke**: Add explicit `stroke="var(--color-border)"` to CartesianGrid

3. **Tooltip contentStyle**: Replace hardcoded styles with:
```typescript
contentStyle={{
  backgroundColor: 'var(--color-popover)',
  border: '1px solid var(--color-border)',
  borderRadius: '8px',
  color: 'var(--color-popover-foreground)',
}}
itemStyle={{ color: 'var(--color-popover-foreground)' }}
labelStyle={{ color: 'var(--color-popover-foreground)' }}
```

4. **LabelList fill**: Replace `fill="#64748b"` with `fill="var(--color-muted-foreground)"`

5. **CardTitle text colors**: Replace `text-slate-800` with `text-foreground`

For DemographicsChart.tsx specifically:
- Replace `hover:bg-slate-50` with `hover:bg-muted/50`
- Replace `text-slate-700/800` with `text-foreground`
- Replace `text-slate-500` with `text-muted-foreground`
- Replace `bg-slate-100` with `bg-muted`

Update imports to include getAxisColor, getBorderColor from chartColors.ts if using those helpers.
  </action>
  <verify>
Run `npm run build --prefix frontend` to verify no errors.
`grep -rE "fill.*#[0-9a-fA-F]{6}|text-slate-[0-9]" frontend/src/components/dashboard/*Chart.tsx` should return minimal/no matches (gender colors may remain).
  </verify>
  <done>
All chart components use CSS variables for axis labels, grid lines, tooltips, and label lists. CardTitles use text-foreground. No hardcoded #64748b hex colors remain in chart configurations.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build --prefix frontend` passes
2. KPICard.tsx contains no text-slate-* classes
3. All *Chart.tsx files use `var(--color-*)` for fill/stroke in Recharts components
4. Tooltip styling uses popover CSS variables
5. chartColors.ts exports CSS variable-based color functions
</verification>

<success_criteria>
- KPI card labels use text-muted-foreground
- KPI card values use text-foreground
- KPI icon backgrounds use bg-muted
- Chart axis labels use var(--color-muted-foreground)
- Chart tooltips use var(--color-popover) background
- Chart grids use var(--color-border)
- chartColors.ts returns CSS variable references
- All chart components build without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-dark-mode-coverage/02-02-SUMMARY.md`
</output>
