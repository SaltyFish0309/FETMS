---
phase: 04-content-translation
plan: 08
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/pages/Dashboard.tsx
  - frontend/src/components/dashboard/EducationChart.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Dashboard filter badges display enum values in selected language"
    - "Education Level chart displays degree labels in selected language"
    - "Filter badge shows '狀態: 續聘' not '狀態: Re-Hired' when Chinese selected"
  artifacts:
    - path: "frontend/src/pages/Dashboard.tsx"
      provides: "Filter badge enum translation"
      contains: "useTranslation.*teachers"
    - path: "frontend/src/components/dashboard/EducationChart.tsx"
      provides: "Chart data enum translation"
      contains: "useTranslation.*teachers"
  key_links:
    - from: "frontend/src/pages/Dashboard.tsx"
      to: "frontend/public/locales/*/teachers.json"
      via: "enum translation lookup"
      pattern: "enums\\.(status|gender|degree)"
    - from: "frontend/src/components/dashboard/EducationChart.tsx"
      to: "frontend/public/locales/*/teachers.json"
      via: "degree enum translation"
      pattern: "enums\\.degree"
---

<objective>
Translate Dashboard filter badges and Education chart enum values to close UAT gap.

Purpose: Fix UAT Test 6 failure - Filter badges and Education Level chart display raw English enum values (e.g., "Re-Hired", "Bachelor") instead of translating them when language is Traditional Chinese.

Output: Dashboard filter badges and EducationChart component translate enum values using the established teachers:enums.* pattern from Phase 04-04.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-content-translation/04-04-SUMMARY.md
@.planning/phases/04-content-translation/04-06-SUMMARY.md

**Pattern established in 04-04 and 04-06:**
- Enum translations stored in teachers namespace: `enums.status.newly_hired`, `enums.degree.bachelor`, etc.
- Components use: `tTeachers('enums.status.' + status.toLowerCase().replace(/\s+/g, '_'))`
- DemographicsChart already translates status and gender enums using this pattern

**Gap from UAT:**
User reported: "if I apply '續聘' filter, the label in the filter is still English: 狀態:Re-Hired. Furthermore, in the chart '教育程度', it's still in English, 'Bachelor' and 'Master'."

Root cause:
1. Dashboard.tsx lines 140-156 render filter badges with raw enum values
2. EducationChart.tsx receives data with English enum values and displays them without translation

**Reference files to review:**
@frontend/src/pages/Dashboard.tsx
@frontend/src/components/dashboard/EducationChart.tsx
@frontend/public/locales/en/teachers.json
@frontend/public/locales/zh-TW/teachers.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Translate filter badge enum values in Dashboard.tsx</name>
  <files>frontend/src/pages/Dashboard.tsx</files>
  <action>
Read Dashboard.tsx and locate the filter badge rendering logic (around lines 140-156).

Current implementation likely renders filter badges like:
```tsx
{filterKey}: {filterValue}
```

Update to translate enum values based on filter type:

1. Import useTranslation for teachers namespace (if not already imported):
```typescript
import { useTranslation } from 'react-i18next';
```

2. Add teachers namespace to translation hooks:
```typescript
const { t } = useTranslation('dashboard');
const { t: tTeachers } = useTranslation('teachers');
```

3. Create a helper function to translate filter values based on filter key:
```typescript
const translateFilterValue = (filterKey: string, value: string): string => {
  // Map filter keys to enum types
  const enumMap: Record<string, string> = {
    'status': 'status',
    'hiringStatus': 'status',
    'gender': 'gender',
    'degree': 'degree',
    'educationLevel': 'degree'
  };
  
  const enumType = enumMap[filterKey];
  
  if (enumType) {
    // Translate as enum value
    const enumKey = value.toLowerCase().replace(/\s+/g, '_').replace(/-/g, '_');
    return tTeachers(`enums.${enumType}.${enumKey}`);
  }
  
  // Return raw value for non-enum filters (nationality, etc.)
  return value;
};
```

4. Update the filter badge rendering to use this helper:
```tsx
{t(filterKey)}: {translateFilterValue(filterKey, filterValue)}
```

Preserve all existing filter logic, badge styling, and clear functionality.
  </action>
  <verify>
1. Check teachers namespace imported:
```bash
grep "useTranslation.*teachers" frontend/src/pages/Dashboard.tsx
```

2. Build succeeds:
```bash
cd frontend && npm run build
```

3. Test filter badges display translated values (manual test after deployment).
  </verify>
  <done>Dashboard.tsx translates enum values in filter badges using teachers:enums.* pattern.</done>
</task>

<task type="auto">
  <name>Task 2: Translate Education chart degree labels in EducationChart.tsx</name>
  <files>frontend/src/components/dashboard/EducationChart.tsx</files>
  <action>
Read EducationChart.tsx and locate how data is passed to the chart component.

Current implementation receives data array with structure like:
```typescript
[
  { name: "Bachelor", value: 15 },
  { name: "Master", value: 8 }
]
```

The YAxis displays `item.name` directly without translation.

Update to translate degree enum values:

1. Import useTranslation hook:
```typescript
import { useTranslation } from 'react-i18next';
```

2. Inside the component, add:
```typescript
const { t } = useTranslation('teachers');
```

3. Create a translated data array before rendering:
```typescript
// Translate degree labels
const translatedData = data.map(item => ({
  ...item,
  name: t(`enums.degree.${item.name.toLowerCase().replace(/\s+/g, '_')}`)
}));
```

4. Use `translatedData` instead of `data` in the BarChart component:
```tsx
<BarChart data={translatedData}>
  {/* ... */}
</BarChart>
```

Preserve all chart configuration, colors, tooltips, and styling. Only translate the degree labels.
  </action>
  <verify>
1. Check useTranslation import exists:
```bash
grep "useTranslation" frontend/src/components/dashboard/EducationChart.tsx
```

2. Verify data transformation logic added:
```bash
grep "translatedData" frontend/src/components/dashboard/EducationChart.tsx
```

3. Build succeeds:
```bash
cd frontend && npm run build
```
  </verify>
  <done>EducationChart.tsx translates degree labels using teachers:enums.degree.* pattern before rendering chart.</done>
</task>

</tasks>

<verification>
1. Visit Dashboard page
2. Apply a status filter (e.g., "Re-Hired" / "續聘")
3. Switch language to Traditional Chinese
4. Verify filter badge shows "狀態: 續聘" not "狀態: Re-Hired"
5. Check Education Level chart displays "學士" and "碩士" instead of "Bachelor" and "Master"
6. Switch back to English and confirm English labels appear
</verification>

<success_criteria>
- Dashboard filter badges translate enum values correctly when language changes
- Education Level chart displays degree labels in selected language
- No raw English enum values appear when Traditional Chinese is selected
- UAT Test 6 gap closed: Filter values and chart data fully translated
</success_criteria>

<output>
After completion, create `.planning/phases/04-content-translation/04-08-SUMMARY.md`
</output>
