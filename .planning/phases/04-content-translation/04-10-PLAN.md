---
phase: 04-content-translation
plan: 10
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/pages/TeacherProfile.tsx
  - frontend/src/components/schools/ImportSchoolsDialog.tsx
  - frontend/src/pages/SchoolProfile.tsx
  - frontend/public/locales/en/schools.json
  - frontend/public/locales/zh-TW/schools.json
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Teacher profile status badge displays translated enum value"
    - "Teacher profile date labels (Expiry Date, Issue Date) translate"
    - "Schools page Import CSV button and dialog translate"
    - "School profile status values display in selected language"
    - "Contact Person label in Chinese is '負責人' not '主要人員'"
  artifacts:
    - path: "frontend/src/pages/TeacherProfile.tsx"
      provides: "Profile status badge and date label translations"
      contains: "enums\\.status"
    - path: "frontend/src/components/schools/ImportSchoolsDialog.tsx"
      provides: "Schools import dialog translations"
      contains: "useTranslation.*schools"
    - path: "frontend/src/pages/SchoolProfile.tsx"
      provides: "School profile enum translations"
      contains: "teachers.*enums\\.status"
    - path: "frontend/public/locales/en/schools.json"
      provides: "Import dialog English keys"
      contains: "importDialog"
    - path: "frontend/public/locales/zh-TW/schools.json"
      provides: "Import dialog Chinese translations and fixed Contact Person label"
      contains: "負責人"
  key_links:
    - from: "frontend/src/pages/TeacherProfile.tsx"
      to: "frontend/public/locales/*/teachers.json"
      via: "enum translation pattern"
      pattern: "enums\\.status\\."
    - from: "frontend/src/components/schools/ImportSchoolsDialog.tsx"
      to: "frontend/public/locales/*/schools.json"
      via: "useTranslation('schools')"
      pattern: "importDialog\\."
    - from: "frontend/src/pages/SchoolProfile.tsx"
      to: "frontend/public/locales/*/teachers.json"
      via: "cross-namespace enum translation"
      pattern: "teachers.*enums\\.status"
---

<objective>
Fix Teacher and School profile translation gaps and improve translation quality.

Purpose: Fix UAT Test 9 and Test 10 failures:
- Test 9: Teacher profile status badge and date labels still in English
- Test 10: Schools Import CSV dialog missing, status values untranslated, Contact Person translation quality issue

Output: Teacher/School profiles fully translated with proper enum handling and improved Chinese translations.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-content-translation/04-04-SUMMARY.md
@.planning/phases/04-content-translation/04-05-SUMMARY.md
@.planning/phases/04-content-translation/04-06-SUMMARY.md

**Pattern established:**
- Enum values translate using teachers:enums.* pattern
- Cross-namespace imports allowed (School profile can import teachers namespace for status enums)
- Profile fields use {namespace}.profile.fields.* pattern

**Gaps from UAT:**

Test 9: "Pass, but a few places are still in English: 1) Newly Hired in Badge, 2) Expiry Date and Issue Date labels"
- TeacherProfile.tsx line 400: status badge displays raw enum value
- Lines 867, 887: Expiry Date and Issue Date hardcoded

Test 10: "A few places not in English: 1) Import CSV button 2) Re-Hired status in table. One minor better translation: 主要人員 should be 負責人 instead"
- ImportSchoolsDialog.tsx: 10+ hardcoded strings, no i18n integration
- SchoolProfile.tsx line 241: status rendered without translation
- zh-TW/schools.json: 主要人員 should be 負責人

**Reference files to review:**
@frontend/src/pages/TeacherProfile.tsx
@frontend/src/components/schools/ImportSchoolsDialog.tsx
@frontend/src/pages/SchoolProfile.tsx
@frontend/public/locales/en/schools.json
@frontend/public/locales/zh-TW/schools.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Teacher profile status badge and date labels</name>
  <files>frontend/src/pages/TeacherProfile.tsx</files>
  <action>
Read TeacherProfile.tsx and locate the three specific issues:

1. **Status Badge (line ~400)**: Currently displays `teacher.personalInfo.hiringStatus` directly.
   
   Update to translate the enum value:
   ```tsx
   {t('enums.status.' + teacher.personalInfo.hiringStatus.toLowerCase().replace(/\s+/g, '_').replace(/-/g, '_'))}
   ```

2. **Expiry Date label (line ~867)**: Hardcoded "Expiry Date" string.
   
   Replace with:
   ```tsx
   {t('profile.fields.expiryDate')}
   ```

3. **Issue Date label (line ~887)**: Hardcoded "Issue Date" string.
   
   Replace with:
   ```tsx
   {t('profile.fields.issueDate')}
   ```

Verify that useTranslation('teachers') hook is already present in the component. If not, add it.

Also verify that teachers.json locale files contain these keys (they should exist from 04-04):
- `profile.fields.expiryDate`
- `profile.fields.issueDate`

If missing, add them to both en/teachers.json and zh-TW/teachers.json.

Preserve all existing profile layout, styling, and data display logic.
  </action>
  <verify>
1. Check status badge translation pattern:
```bash
grep -A2 "hiringStatus" frontend/src/pages/TeacherProfile.tsx | grep "enums.status"
```
Should find the translation pattern.

2. Check date labels use t():
```bash
grep "profile.fields.expiryDate\|profile.fields.issueDate" frontend/src/pages/TeacherProfile.tsx
```
Should find both translation keys.

3. Build succeeds:
```bash
cd frontend && npm run build
```
  </verify>
  <done>TeacherProfile.tsx translates status badge enum value and date labels using teachers namespace.</done>
</task>

<task type="auto">
  <name>Task 2: Add Schools import dialog translation keys</name>
  <files>
    frontend/public/locales/en/schools.json
    frontend/public/locales/zh-TW/schools.json
  </files>
  <action>
Add translation keys for the Schools import dialog to both locale files.

**In en/schools.json, add:**
```json
"importDialog": {
  "trigger": "Import CSV",
  "title": "Import Schools",
  "description": "Upload a CSV file to import multiple schools at once",
  "selectFile": "Select CSV File",
  "dragDrop": "or drag and drop",
  "fileInfo": "CSV file up to 10MB",
  "uploading": "Uploading...",
  "cancel": "Cancel",
  "import": "Import",
  "success": "{{count}} schools imported successfully",
  "error": "Failed to import schools"
}
```

**In zh-TW/schools.json, add:**
```json
"importDialog": {
  "trigger": "匯入 CSV",
  "title": "匯入學校",
  "description": "上傳 CSV 檔案以批次匯入多所學校",
  "selectFile": "選擇 CSV 檔案",
  "dragDrop": "或拖放檔案",
  "fileInfo": "CSV 檔案最大 10MB",
  "uploading": "上傳中...",
  "cancel": "取消",
  "import": "匯入",
  "success": "成功匯入 {{count}} 所學校",
  "error": "匯入學校失敗"
}
```

**Also in zh-TW/schools.json**, fix the Contact Person translation:

Find the existing `keyPersonnel` or `contactPerson` key and update it from "主要人員" to "負責人".

If the structure is like `"profile": { "fields": { "contactPerson": "主要人員" } }`, change it to:
```json
"profile": {
  "fields": {
    "contactPerson": "負責人"
  }
}
```

Preserve all existing schools.json structure and keys.
  </action>
  <verify>
Check both files have valid JSON syntax:
```bash
cd frontend && npm run build
```

Verify Contact Person fix:
```bash
grep "負責人" frontend/public/locales/zh-TW/schools.json
```
Should find the corrected translation.
  </verify>
  <done>Schools locale files contain importDialog keys and Contact Person translation is corrected to 負責人.</done>
</task>

<task type="auto">
  <name>Task 3: Integrate i18n in ImportSchoolsDialog component</name>
  <files>frontend/src/components/schools/ImportSchoolsDialog.tsx</files>
  <action>
Read ImportSchoolsDialog.tsx and integrate i18n following the same pattern as ImportTeachersDialog from Plan 04-09.

1. Import useTranslation hook at the top:
```typescript
import { useTranslation } from 'react-i18next';
```

2. Inside the component function, add:
```typescript
const { t } = useTranslation('schools');
```

3. Replace all hardcoded English strings with t() calls using the importDialog.* keys added in Task 2:
   - Trigger button: t('importDialog.trigger')
   - Dialog title: t('importDialog.title')
   - Description: t('importDialog.description')
   - File input labels: t('importDialog.selectFile'), t('importDialog.dragDrop'), t('importDialog.fileInfo')
   - Button labels: t('importDialog.cancel'), t('importDialog.import')
   - Loading state: t('importDialog.uploading')
   - Toast messages: t('importDialog.success', { count: X }), t('importDialog.error')

Preserve all existing file upload logic, CSV parsing, validation, and styling.
  </action>
  <verify>
1. Check import statement exists:
```bash
grep "useTranslation" frontend/src/components/schools/ImportSchoolsDialog.tsx
```

2. Verify no hardcoded "Import CSV" text:
```bash
grep -E '"(Import CSV|Import Schools|Upload)"' frontend/src/components/schools/ImportSchoolsDialog.tsx
```
Should return minimal or no matches.

3. Build succeeds:
```bash
cd frontend && npm run build
```
  </verify>
  <done>ImportSchoolsDialog.tsx uses useTranslation('schools') hook and all UI strings replaced with t() calls.</done>
</task>

<task type="auto">
  <name>Task 4: Translate status enum in SchoolProfile component</name>
  <files>frontend/src/pages/SchoolProfile.tsx</files>
  <action>
Read SchoolProfile.tsx and locate line ~241 where hiring status is rendered.

Currently displays raw enum value like "Re-Hired" directly without translation.

Update to translate the status enum:

1. Check if useTranslation is already imported. If not, add:
```typescript
import { useTranslation } from 'react-i18next';
```

2. Add teachers namespace for enum translation (status enums live in teachers namespace):
```typescript
const { t } = useTranslation('schools');
const { t: tTeachers } = useTranslation('teachers');
```

3. Where status is rendered, replace raw value with:
```tsx
{tTeachers('enums.status.' + status.toLowerCase().replace(/\s+/g, '_').replace(/-/g, '_'))}
```

This follows the same cross-namespace pattern used in DemographicsChart (04-06) where dashboard components imported teachers namespace for enum translations.

Preserve all existing school profile layout, data display, and styling.
  </action>
  <verify>
1. Check teachers namespace imported:
```bash
grep "useTranslation.*teachers" frontend/src/pages/SchoolProfile.tsx
```

2. Check status translation pattern:
```bash
grep "enums.status" frontend/src/pages/SchoolProfile.tsx
```
Should find the translation pattern.

3. Build succeeds:
```bash
cd frontend && npm run build
```
  </verify>
  <done>SchoolProfile.tsx translates hiring status enum values using teachers:enums.status.* pattern.</done>
</task>

</tasks>

<verification>
1. Visit Teacher Profile page
2. Switch language to Traditional Chinese
3. Verify status badge shows "新進聘用" or "續聘" (not "Newly Hired" or "Re-Hired")
4. Verify date labels show Chinese text (not "Expiry Date" or "Issue Date")
5. Visit Schools page
6. Click "匯入 CSV" button - dialog should show Chinese text
7. Visit School Profile page
8. Verify hiring status shows Chinese enum values
9. Verify Contact Person label shows "負責人" (not "主要人員")
</verification>

<success_criteria>
- Teacher profile status badge translates correctly
- Teacher profile date labels display in selected language
- Schools Import CSV dialog fully translated
- School profile status enum values display in selected language
- Contact Person label uses improved Chinese translation "負責人"
- UAT Test 9 and Test 10 gaps closed: Profiles and Schools import fully translated
</success_criteria>

<output>
After completion, create `.planning/phases/04-content-translation/04-10-SUMMARY.md`
</output>
