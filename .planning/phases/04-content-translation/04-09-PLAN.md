---
phase: 04-content-translation
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/teachers/ImportTeachersDialog.tsx
  - frontend/src/components/teachers/list/DataTableViewOptions.tsx
  - frontend/src/components/teachers/list/filters/FilterSheet.tsx
  - frontend/public/locales/en/teachers.json
  - frontend/public/locales/zh-TW/teachers.json
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Import CSV button and dialog translate when language changes"
    - "Column Visibility dropdown displays all options in selected language"
    - "Filter sheet sidebar shows translated labels and UI text"
  artifacts:
    - path: "frontend/src/components/teachers/ImportTeachersDialog.tsx"
      provides: "Import dialog translations"
      contains: "useTranslation.*teachers"
    - path: "frontend/src/components/teachers/list/DataTableViewOptions.tsx"
      provides: "Column visibility translations"
      contains: "useTranslation.*teachers"
    - path: "frontend/src/components/teachers/list/filters/FilterSheet.tsx"
      provides: "Filter sheet translations"
      contains: "useTranslation.*teachers"
    - path: "frontend/public/locales/en/teachers.json"
      provides: "English keys for import, columnVisibility, filterSheet"
      contains: "importDialog"
    - path: "frontend/public/locales/zh-TW/teachers.json"
      provides: "Chinese translations for import, columnVisibility, filterSheet"
      contains: "importDialog"
  key_links:
    - from: "frontend/src/components/teachers/ImportTeachersDialog.tsx"
      to: "frontend/public/locales/*/teachers.json"
      via: "useTranslation('teachers')"
      pattern: "importDialog\\."
    - from: "frontend/src/components/teachers/list/DataTableViewOptions.tsx"
      to: "frontend/public/locales/*/teachers.json"
      via: "useTranslation('teachers')"
      pattern: "columnVisibility\\."
    - from: "frontend/src/components/teachers/list/filters/FilterSheet.tsx"
      to: "frontend/public/locales/*/teachers.json"
      via: "useTranslation('teachers')"
      pattern: "filterSheet\\."
---

<objective>
Translate Teachers page import dialog, column visibility, and filter sheet to close UAT gap.

Purpose: Fix UAT Test 8 failure - Import CSV button, Column Visibility dropdown, and filter sidebar are missing i18n integration, showing hardcoded English text when language is Traditional Chinese.

Output: All three components fully translated with proper Traditional Chinese support.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-content-translation/04-04-SUMMARY.md

**Pattern established in 04-04:**
- Teachers page uses 'teachers' namespace
- All teacher-related UI uses t() with teachers namespace keys
- Column headers already translated via columns.tsx hook pattern

**Gap from UAT:**
User reported: "The filter side window and the labels are still in English. Column Visibility is all in English as well. The button 'Import CSV' is English, too."

Root cause: Three components lack i18n integration - all have hardcoded English strings and no useTranslation hook.

**Reference files to review:**
@frontend/src/components/teachers/ImportTeachersDialog.tsx
@frontend/src/components/teachers/list/DataTableViewOptions.tsx
@frontend/src/components/teachers/list/filters/FilterSheet.tsx
@frontend/public/locales/en/teachers.json
@frontend/public/locales/zh-TW/teachers.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add translation keys for import, column visibility, and filter sheet</name>
  <files>
    frontend/public/locales/en/teachers.json
    frontend/public/locales/zh-TW/teachers.json
  </files>
  <action>
Add translation keys to both locale files for the three components.

**In en/teachers.json, add:**
```json
"importDialog": {
  "trigger": "Import CSV",
  "title": "Import Teachers",
  "description": "Upload a CSV file to import multiple teachers at once",
  "selectFile": "Select CSV File",
  "dragDrop": "or drag and drop",
  "fileInfo": "CSV file up to 10MB",
  "uploading": "Uploading...",
  "cancel": "Cancel",
  "import": "Import",
  "success": "{{count}} teachers imported successfully",
  "error": "Failed to import teachers"
},
"columnVisibility": {
  "trigger": "Columns",
  "title": "Toggle Columns",
  "search": "Search columns...",
  "showAll": "Show All",
  "hideAll": "Hide All",
  "noResults": "No columns found"
},
"filterSheet": {
  "title": "Filters",
  "search": "Search filters...",
  "activeFilters": "{{count}} active",
  "reset": "Reset",
  "apply": "Apply",
  "noFilters": "No filters available",
  "clear": "Clear"
}
```

**In zh-TW/teachers.json, add:**
```json
"importDialog": {
  "trigger": "匯入 CSV",
  "title": "匯入教師",
  "description": "上傳 CSV 檔案以批次匯入多位教師",
  "selectFile": "選擇 CSV 檔案",
  "dragDrop": "或拖放檔案",
  "fileInfo": "CSV 檔案最大 10MB",
  "uploading": "上傳中...",
  "cancel": "取消",
  "import": "匯入",
  "success": "成功匯入 {{count}} 位教師",
  "error": "匯入教師失敗"
},
"columnVisibility": {
  "trigger": "欄位",
  "title": "顯示欄位",
  "search": "搜尋欄位...",
  "showAll": "全部顯示",
  "hideAll": "全部隱藏",
  "noResults": "找不到欄位"
},
"filterSheet": {
  "title": "篩選",
  "search": "搜尋篩選...",
  "activeFilters": "{{count}} 個篩選條件",
  "reset": "重設",
  "apply": "套用",
  "noFilters": "無可用篩選",
  "clear": "清除"
}
```

Preserve existing teachers.json structure and add these as new top-level keys alongside existing keys.
  </action>
  <verify>
Check both files have valid JSON syntax:
```bash
cd frontend && npm run build
```
No JSON parse errors should occur.
  </verify>
  <done>Both teachers.json locale files contain importDialog, columnVisibility, and filterSheet translation keys.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate i18n in ImportTeachersDialog component</name>
  <files>frontend/src/components/teachers/ImportTeachersDialog.tsx</files>
  <action>
Read ImportTeachersDialog.tsx to identify all hardcoded strings, then:

1. Import useTranslation hook at the top:
```typescript
import { useTranslation } from 'react-i18next';
```

2. Inside the component function, add:
```typescript
const { t } = useTranslation('teachers');
```

3. Replace all hardcoded English strings with t() calls:
   - Trigger button: t('importDialog.trigger')
   - Dialog title: t('importDialog.title')
   - Description: t('importDialog.description')
   - File input labels: t('importDialog.selectFile'), t('importDialog.dragDrop'), t('importDialog.fileInfo')
   - Button labels: t('importDialog.cancel'), t('importDialog.import')
   - Loading state: t('importDialog.uploading')
   - Toast messages: t('importDialog.success', { count: X }), t('importDialog.error')

Preserve all existing file upload logic, validation, error handling, and styling.
  </action>
  <verify>
1. Check import statement exists:
```bash
grep "useTranslation" frontend/src/components/teachers/ImportTeachersDialog.tsx
```

2. Verify no hardcoded "Import CSV" or dialog text remains:
```bash
grep -E '"(Import CSV|Upload|Select|drag and drop)"' frontend/src/components/teachers/ImportTeachersDialog.tsx
```
Should return minimal or no matches (only prop names allowed).

3. Build succeeds:
```bash
cd frontend && npm run build
```
  </verify>
  <done>ImportTeachersDialog.tsx uses useTranslation('teachers') hook and all UI strings replaced with t() calls.</done>
</task>

<task type="auto">
  <name>Task 3: Integrate i18n in DataTableViewOptions component</name>
  <files>frontend/src/components/teachers/list/DataTableViewOptions.tsx</files>
  <action>
Read DataTableViewOptions.tsx to identify all hardcoded strings, then:

1. Import useTranslation hook at the top:
```typescript
import { useTranslation } from 'react-i18next';
```

2. Inside the component function, add:
```typescript
const { t } = useTranslation('teachers');
```

3. Replace all hardcoded English strings with t() calls:
   - Trigger button label: t('columnVisibility.trigger')
   - Dropdown header: t('columnVisibility.title')
   - Search placeholder: t('columnVisibility.search')
   - Action buttons: t('columnVisibility.showAll'), t('columnVisibility.hideAll')
   - Empty state: t('columnVisibility.noResults')

Note: Column names themselves are already translated via the columns.tsx hook pattern from 04-04. Only translate the UI controls, not the column labels.

Preserve all existing column toggle logic, search functionality, and styling.
  </action>
  <verify>
1. Check import statement exists:
```bash
grep "useTranslation" frontend/src/components/teachers/list/DataTableViewOptions.tsx
```

2. Verify no hardcoded "Columns" or "Toggle" text:
```bash
grep -E '"(Columns|Toggle|Show All|Hide All)"' frontend/src/components/teachers/list/DataTableViewOptions.tsx
```
Should return no matches.

3. Build succeeds:
```bash
cd frontend && npm run build
```
  </verify>
  <done>DataTableViewOptions.tsx uses useTranslation('teachers') hook and all UI controls translated.</done>
</task>

<task type="auto">
  <name>Task 4: Integrate i18n in FilterSheet component</name>
  <files>frontend/src/components/teachers/list/filters/FilterSheet.tsx</files>
  <action>
Read FilterSheet.tsx to identify all hardcoded strings, then:

1. Import useTranslation hook at the top:
```typescript
import { useTranslation } from 'react-i18next';
```

2. Inside the component function, add:
```typescript
const { t } = useTranslation('teachers');
```

3. Replace all hardcoded English strings with t() calls:
   - Sheet title: t('filterSheet.title')
   - Search placeholder: t('filterSheet.search')
   - Active filter badge: t('filterSheet.activeFilters', { count: X })
   - Button labels: t('filterSheet.reset'), t('filterSheet.apply'), t('filterSheet.clear')
   - Empty state: t('filterSheet.noFilters')

Note: Filter labels themselves (Status, Nationality, etc.) are already translated from the teachers namespace in 04-04. Only translate the FilterSheet UI controls.

Preserve all existing filter management logic, sheet animations, and styling.
  </action>
  <verify>
1. Check import statement exists:
```bash
grep "useTranslation" frontend/src/components/teachers/list/filters/FilterSheet.tsx
```

2. Verify no hardcoded "Filters" or "Reset" text:
```bash
grep -E '"(Filters|Reset|Apply|active)"' frontend/src/components/teachers/list/filters/FilterSheet.tsx
```
Should return no matches.

3. Build succeeds:
```bash
cd frontend && npm run build
```
  </verify>
  <done>FilterSheet.tsx uses useTranslation('teachers') hook and all UI controls translated.</done>
</task>

</tasks>

<verification>
1. Visit Teachers page
2. Switch language to Traditional Chinese
3. Click "匯入 CSV" button (Import CSV) - dialog should show Chinese text
4. Click "欄位" button (Columns) - dropdown should show "顯示欄位" header
5. Click filter icon - sidebar should show "篩選" title and Chinese labels
6. Switch back to English and verify all UI displays in English
</verification>

<success_criteria>
- Import CSV button and dialog fully translated
- Column Visibility dropdown shows all UI text in selected language
- Filter sheet sidebar displays translated labels and controls
- No English UI text appears when Traditional Chinese is selected
- UAT Test 8 gap closed: Teachers page filters, columns, and import fully translated
</success_criteria>

<output>
After completion, create `.planning/phases/04-content-translation/04-09-SUMMARY.md`
</output>
