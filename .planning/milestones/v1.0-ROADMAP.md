# Milestone v1.0: User Preferences

**Status:** ✅ SHIPPED 2026-01-30
**Phases:** 1-5
**Total Plans:** 33

## Overview

Transforms the FETMS User Preferences feature into a fully-functional, industry-standard settings system. Includes dark mode, internationalization (EN/ZH-TW), and accessibility preferences (font size, density, reduced motion).

## Phases

### Phase 1: Theme Infrastructure

**Goal**: Dark mode works correctly with proper Tailwind configuration, no flash of unstyled content, and semantic color tokens ready for component styling
**Depends on**: Nothing (first phase)
**Plans**: 1 plans

Plans:

- [x] 01-01-PLAN.md — Configure Tailwind dark mode and add FOUC prevention

**Details:**
**Requirements**: DARK-01, DARK-02, DARK-03, DARK-04

**Success Criteria** (what must be TRUE):
  1. User switches between Light/Dark/System theme modes without visual glitches
  2. Page loads in correct theme without flashing white (FOUC prevented)
  3. Theme preference persists across browser sessions
  4. All Shadcn/UI components can reference semantic color tokens (--background, --foreground, --primary)


### Phase 2: Component Dark Mode Coverage

**Goal**: Every component in the application renders correctly in dark mode with WCAG AA contrast compliance
**Depends on**: Phase 1
**Plans**: 11 plans

Plans:

- [x] 02-01-PLAN.md — Fix header and sidebar dark mode styling
- [x] 02-02-PLAN.md — Update KPICard and all dashboard charts for dark mode
- [x] 02-03-PLAN.md — Fix CandidateList, ExpiryWidget, and Dashboard page
- [x] 02-04-PLAN.md — Update Teachers, Schools, Settings pages for dark mode
- [x] 02-05-PLAN.md — Fix ViewModeToggle, DataTable, and Kanban components
- [x] 02-06-PLAN.md — Add theme transitions and verify WCAG compliance
- [x] 02-07-PLAN.md — Forms & Filters Dark Mode Coverage
- [x] 02-08-PLAN.md — Profile Pages and Remaining Dialogs
- [x] 02-09-PLAN.md — Component Dark Mode Coverage (Gap Closure)
- [x] 02-10-PLAN.md — Final Verification
- [x] 02-11-PLAN.md — Fix SortableColumn dark mode and remove dead code

**Details:**
**Requirements**: DARK-05, DARK-06, DARK-07, DARK-08, DARK-09, DARK-10, DARK-11, DARK-12, DARK-13, DARK-14, DARK-15, DARK-16, DARK-17, DARK-18, DARK-19

**Success Criteria** (what must be TRUE):
  1. Header/navigation adapts to dark theme with proper background and text color
  2. All pages (Dashboard, Teachers, Schools, Settings) display correctly in dark mode
  3. All interactive elements (forms, tables, modals, dropdowns) have proper contrast in dark mode
  4. Dashboard charts (Recharts) use dark-compatible colors
  5. All text meets WCAG AA contrast ratio (4.5:1 minimum) in dark mode


### Phase 3: i18n Infrastructure

**Goal**: Application has full internationalization infrastructure with language toggle working between Traditional Chinese and English
**Depends on**: Phase 2
**Plans**: 3 plans

Plans:

- [x] 03-01-PLAN.md — Install and configure i18next ecosystem
- [x] 03-02-PLAN.md — Implement language toggle UI and Traditional Chinese fonts
- [x] 03-03-PLAN.md — Fix missing active state indication in LanguageToggle component (Gap Closure)

**Details:**
**Requirements**: I18N-01, I18N-02, I18N-03, I18N-04, I18N-05, I18N-06, I18N-07, I18N-08

**Success Criteria** (what must be TRUE):
  1. User can toggle language between Traditional Chinese and English from Settings page
  2. Language preference persists across browser sessions
  3. Browser language auto-detected on first visit to set initial language
  4. Language switches instantly without page reload
  5. Traditional Chinese text renders with proper font stack (no Simplified Chinese fallback)


### Phase 4: Content Translation

**Goal**: All user-facing content is available in both Traditional Chinese and English with proper formatting
**Depends on**: Phase 3
**Plans**: 13 plans

Plans:

- [x] 04-01-PLAN.md — Translate Common UI and Navigation
- [x] 04-02-PLAN.md — Translate Settings Page
- [x] 04-03-PLAN.md — Translate Dashboard Page
- [x] 04-04-PLAN.md — Translate Teachers Page
- [x] 04-05-PLAN.md — Translate Schools and Documents Pages
- [x] 04-06-PLAN.md — Translate Validation, Errors, and Enums
- [x] 04-07-PLAN.md — Translate Dashboard Action Center and Qualified Candidates (Gap Closure)
- [x] 04-08-PLAN.md — Translate Dashboard Filter Badges and Education Chart (Gap Closure)
- [x] 04-09-PLAN.md — Translate Teachers Import, Column Visibility, and Filters (Gap Closure)
- [x] 04-10-PLAN.md — Translate Teacher and School Profiles (Gap Closure)
- [x] 04-11-PLAN.md — Translate Alert Settings and Toast Messages (Gap Closure)
- [x] 04-12-PLAN.md — Translate Settings Pages Content (Gap Closure)
- [x] 04-13-PLAN.md — Translate remaining toast messages and placeholders (Gap Closure)

**Details:**
**Requirements**: I18N-09, I18N-10, I18N-11, I18N-12, I18N-13, I18N-14, I18N-15, I18N-16, I18N-17, I18N-18, I18N-19

**Success Criteria** (what must be TRUE):
  1. All navigation, buttons, labels, headings display in selected language
  2. All form validation messages and error notifications display in selected language
  3. Dropdown option values (Status, Hiring Status, Gender) display in selected language
  4. User-generated data (teacher names, school names, notes) remains in original language
  5. Missing translations fall back to English gracefully


### Phase 5: Preferences System

**Goal**: Users can customize font size, display density, and reduced motion preferences with persistence across sessions
**Depends on**: Phase 3
**Plans**: 5 plans

Plans:

- [x] 05-01-PLAN.md — Create PreferencesContext and localStorage service
- [x] 05-02-PLAN.md — Implement font size control with CSS custom properties
- [x] 05-03-PLAN.md — Implement display density control with CSS custom properties
- [x] 05-04-PLAN.md — Implement reduced motion preference with system detection
- [x] 05-05-PLAN.md — Finalize Settings UI organization and add reset functionality

**Details:**
**Requirements**: ACC-01, ACC-02, ACC-03, ACC-04, ACC-05, ACC-06, ACC-07, ACC-08, ACC-09, ACC-10, ACC-11, ACC-12, ACC-13, ACC-14, PREF-01, PREF-02, PREF-03, PREF-04

**Success Criteria** (what must be TRUE):
  1. User can adjust font size (Small/Medium/Large) and all layouts adapt correctly
  2. User can adjust display density (Compact/Comfortable/Spacious) and spacing scales appropriately
  3. User can toggle reduced motion and animations disable when enabled
  4. All preferences persist across browser sessions
  5. Preference changes sync across multiple tabs in real-time
  6. Settings page is organized into clear sections (Appearance, Language, Accessibility)


---

## Milestone Summary

**Key Decisions:**

- **Root-based Font Scaling (05-05):** Apply font-size to :root to scale all rem-based UI elements proportionally.
- **Explicit Motion Override (05-05):** Allow users to force-enable motion even if system prefers reduced motion.
- **Targeted Density Scaling (05-03):** Apply density scaling to key elements only (main, cards, common gaps) rather than globally to avoid breaking complex layouts.
- **Proportional Font Scaling via Body (05-02):** Set font-size on body (moved to root in 05-05).
- **Silent Cross-tab Sync (05-01):** Storage events update preferences automatically without user notification.
- **Dynamic Toast Messages (04-13):** Keep 'Moved to {stage}' dynamic message for UX context instead of generic translation.
- **Mocking Radix UI (03-03):** Mocked Radix UI components in tests to avoid portal/interaction complexity.
- **Class-based Dark Mode (01-01):** Use `darkMode: 'class'` to match next-themes implementation.
- **Blocking FOUC script (01-01):** Use synchronous script to prevent flash of unstyled content.

**Issues Resolved:**

- Fixed broken dark mode (FOUC, inconsistent styling) across all components.
- Added missing active state to language toggle (Phase 3).
- Fixed Kanban SortableColumn colors hardcoded to slate-300 (Phase 2).
- Fixed TypeScript strict errors in translation keys for nested paths (Phase 4).
- Removed unused legacy Layout component (Phase 2).

**Issues Deferred:**

- Translation of user-generated data (deferred for data integrity).
- Advanced settings (column visibility, notification prefs) - deferred to v2.
- Mobile app preferences (web-first approach).

**Technical Debt Incurred:**

- Hardcoded text in low-traffic components (`BoxManagementDialogs.tsx`).
- Some reusable UI components have hardcoded placeholders (e.g. 'Search country...').
- One toast message remains partially hardcoded for dynamic context ("Moved to {stage}").

---

_For current project status, see .planning/ROADMAP.md_
