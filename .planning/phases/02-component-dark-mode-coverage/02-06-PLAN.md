---
phase: 02-component-dark-mode-coverage
plan: 06
type: execute
wave: 2
depends_on:
  - 02-01
  - 02-02
  - 02-03
  - 02-04
  - 02-05
  - 02-07
  - 02-08
files_modified:
  - frontend/src/index.css
autonomous: false

must_haves:
  truths:
    - "Theme transitions are smooth without jarring color jumps"
    - "All text meets WCAG AA 4.5:1 contrast ratio in dark mode"
    - "Focus indicators are visible in both light and dark modes"
    - "No hardcoded slate/white colors remain in application components"
    - "Shadcn UI components use semantic color tokens"
  artifacts:
    - path: "frontend/src/index.css"
      provides: "Smooth theme transitions"
      contains: "transition-colors"
  key_links:
    - from: "All component files"
      to: "CSS variables in index.css"
      via: "Semantic Tailwind classes"
      pattern: "(bg-card|text-foreground|text-muted-foreground|bg-muted|border-border)"
---

<objective>
Verify Shadcn UI components use semantic tokens, add smooth theme transitions, and verify WCAG AA contrast compliance across all components.

Purpose: Per user decisions, theme transitions should be smooth without visual glitches, and focus indicators must be high contrast (WCAG AAA) for accessibility. This plan verifies Shadcn primitives, adds transition utilities, and performs final verification.

Output: Polished dark mode experience with smooth transitions and verified accessibility compliance.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-component-dark-mode-coverage/02-CONTEXT.md
@.planning/phases/02-component-dark-mode-coverage/02-RESEARCH.md
@frontend/src/index.css
@frontend/src/components/ui/dialog.tsx
@frontend/src/components/ui/dropdown-menu.tsx
@frontend/src/components/ui/input.tsx
@frontend/src/components/ui/select.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify Shadcn UI components use semantic tokens</name>
  <files>
    frontend/src/components/ui/dialog.tsx
    frontend/src/components/ui/dropdown-menu.tsx
    frontend/src/components/ui/input.tsx
    frontend/src/components/ui/select.tsx
    frontend/src/components/ui/table.tsx
  </files>
  <action>
Audit key Shadcn UI components to verify they use semantic color tokens (not hardcoded colors).

**Expected semantic patterns (should already exist):**

Dialog:
- `bg-background` for DialogContent
- `text-muted-foreground` for DialogDescription
- `ring-offset-background` for focus states

DropdownMenu:
- `bg-popover text-popover-foreground` for DropdownMenuContent
- `focus:bg-accent focus:text-accent-foreground` for items
- `bg-muted` for separator

Input:
- `border-input` for border
- `bg-transparent` or `bg-background` for background
- `text-foreground` for text
- `placeholder:text-muted-foreground` for placeholder
- `focus-visible:ring-ring` for focus

Select:
- Similar patterns to Input and DropdownMenu

Table:
- `border-border` for borders
- `bg-muted/50` or similar for header background

**Verification approach:**
1. Read each file
2. Grep for hardcoded color patterns: `#[0-9a-fA-F]{3,6}`, `rgb(`, `slate-`, `gray-`, `white`, `black`
3. If hardcoded colors found, replace with semantic equivalents
4. If all semantic, document confirmation

Most Shadcn components should already use semantic tokens. This task confirms and fixes any exceptions.
  </action>
  <verify>
`grep -rE "#[0-9a-fA-F]{3,6}|rgb\(|slate-[0-9]|gray-[0-9]" frontend/src/components/ui/dialog.tsx frontend/src/components/ui/dropdown-menu.tsx frontend/src/components/ui/input.tsx frontend/src/components/ui/select.tsx frontend/src/components/ui/table.tsx` should return empty or only comments.
  </verify>
  <done>
Shadcn UI components (Dialog, DropdownMenu, Input, Select, Table) verified to use semantic color tokens. No hardcoded colors in primitives.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add smooth theme transition utilities</name>
  <files>frontend/src/index.css</files>
  <action>
Add transition utilities to the base layer in index.css for smooth theme switching.

In the `@layer base` section, add transition for color-related properties:

```css
@layer base {
  * {
    @apply border-border outline-ring/50;
  }

  body {
    @apply bg-background text-foreground font-sans antialiased;
  }

  /* Smooth theme transitions */
  *,
  *::before,
  *::after {
    @apply transition-colors duration-200;
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      transition-duration: 0.01ms !important;
    }
  }
}
```

This ensures:
1. All color properties (background, text, border) transition smoothly when theme changes
2. 200ms duration is fast enough to feel responsive but slow enough to be noticeable
3. Users who prefer reduced motion get instant transitions (respects accessibility preference)
  </action>
  <verify>
`npm run build --prefix frontend` passes.
`grep -E "transition-colors|prefers-reduced-motion" frontend/src/index.css` should return matches.
  </verify>
  <done>
index.css includes transition-colors utility for smooth theme switching with prefers-reduced-motion support.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete dark mode implementation across all application components:
- Layout components (Header, Sidebar) use semantic colors
- Dashboard components (KPICard, charts, widgets) adapt to theme
- All pages (Teachers, Schools, Settings + sub-pages) use semantic colors
- Profile pages (TeacherProfile, SchoolProfile, Documents) use semantic colors
- Interactive components (ViewModeToggle, DataTable, Kanban) have proper dark styling
- Forms and filters (DateRangeFilter, NumberRangeFilter, FilterSheet) use semantic colors
- All dialogs (Import, Project, Stage, Alert) use semantic colors
- Shadcn UI primitives verified to use semantic tokens
- Theme transitions are smooth with reduced-motion support
  </what-built>
  <how-to-verify>
1. Start the dev server: `npm run dev --prefix frontend`
2. Open http://localhost:5173 in browser

**Theme switching test:**
3. Navigate to Settings > User Preferences
4. Toggle between Light, Dark, and System themes
5. Verify transition is smooth (no jarring color jumps)

**Dark mode visual inspection (in Dark mode):**
6. **Dashboard:** Check KPI cards are readable, charts have visible axis labels, candidate list has proper contrast
7. **Teachers page:** Verify page heading, search input, and table/kanban have proper contrast
8. **Schools page:** Check filter bar background, table rows, and hover states
9. **Teacher Profile:** Verify all sections, forms, and document areas have proper contrast
10. **School Profile:** Check all text and interactive elements
11. **Documents page:** Verify document list and upload areas are dark-mode aware
12. **Settings page:** Verify all cards are readable, icon backgrounds are visible
13. **Settings sub-pages:** Check Alerts, Stages, Import, and Projects pages
14. **Preferences page:** Check all text has proper contrast

**WCAG Contrast verification:**
15. Open browser DevTools (F12)
16. Use the "Accessibility" or "Elements" panel to check contrast ratios:
    - In Chrome: Right-click any text > Inspect > in Styles panel, hover over any color to see contrast ratio
    - Or use Lighthouse: DevTools > Lighthouse > Accessibility audit
17. Verify body text shows >= 4.5:1 contrast ratio (WCAG AA)
18. Verify large text (18px+ or 14px+ bold) shows >= 3:1 contrast ratio

**Focus indicator test:**
19. Tab through interactive elements (buttons, inputs, links)
20. Verify focus rings are clearly visible in dark mode (bright ring, not dim)

**Reduced motion test:**
21. In browser DevTools > Rendering > Emulate CSS media feature `prefers-reduced-motion: reduce`
22. Toggle theme - should switch instantly without transition

**Dialog/Modal test:**
23. Open any dialog (e.g., Add Teacher, Import Teachers)
24. Verify dialog background, text, and form fields have proper dark styling

**Expected behavior:**
- All surfaces use dark backgrounds (not white)
- All text is readable with good contrast (4.5:1 minimum for body text)
- Hover states provide visible feedback
- Focus rings are clearly visible
- No hardcoded white/light gray backgrounds in dark mode
- Theme transition is smooth (200ms)
  </how-to-verify>
  <resume-signal>
Type "approved" if dark mode works correctly across all pages with proper WCAG contrast.
If issues found, describe the specific component and problem (e.g., "KPI card title too dim - contrast ratio 3.2:1", "Table header blends with rows").
  </resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build --prefix frontend` passes
2. Shadcn UI components verified to use semantic tokens
3. index.css contains transition-colors and prefers-reduced-motion rules
4. Human verification confirms visual quality across all pages
5. WCAG AA contrast verified via DevTools/Lighthouse
6. No hardcoded slate/white colors remain (verified via grep in prior plans)
</verification>

<success_criteria>
- Shadcn UI primitives use semantic color tokens (verified)
- Theme transition is smooth (200ms duration)
- Reduced motion preference is respected
- All pages display correctly in dark mode (human verified)
- Text contrast meets WCAG AA (4.5:1 minimum, measured via DevTools)
- Focus indicators are visible in dark mode
- No visual glitches during theme switching
- All requirements DARK-05 through DARK-19 are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-dark-mode-coverage/02-06-SUMMARY.md`
</output>
